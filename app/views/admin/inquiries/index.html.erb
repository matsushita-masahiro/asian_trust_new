<!-- app/views/admin/inquiries/index.html.erb -->
<section id="inquiries">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>お問い合わせ一覧</h2>
    <%= link_to "ダッシュボード", admin_root_path, class: "btn btn-outline-primary" %>
  </div>
  <hr>
  <table class="table table-hover">
    <thead>
      <tr>
        <th>名前</th>
        <th>メール</th>
        <th>送信日時</th>
        <th class="d-none">操作</th> <!-- 非表示 -->
      </tr>
    </thead>
    <tbody>
      <% @inquiries.each do |inquiry| %>
        <tr class="clickable-row" data-href="<%= admin_inquiry_path(inquiry) %>">
          <td><%= inquiry.name %></td>
          <td><%= inquiry.email %></td>
          <td><%= inquiry.created_at.in_time_zone('Asia/Tokyo').strftime("%Y/%m/%d %H:%M") %></td>
          <td class="d-none">
            <%= link_to "詳細", admin_inquiry_path(inquiry), class: "btn btn-sm btn-outline-primary" %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
</section>

<script>
  // Turbo対応のイベントリスナー
  function initializeClickableRows() {
    const clickableRows = document.querySelectorAll('.clickable-row');
    
    clickableRows.forEach(function(row) {
      // 既にイベントリスナーが追加されている場合はスキップ
      if (row.dataset.initialized) return;
      
      row.addEventListener('click', function() {
        const href = this.getAttribute('data-href');
        if (href) {
          window.location.href = href;
        }
      });
      
      // マウスオーバー時にカーソルをポインターに変更
      row.style.cursor = 'pointer';
      
      // 初期化済みマークを付ける
      row.dataset.initialized = 'true';
    });
  }

  // 複数のイベントに対応
  document.addEventListener('DOMContentLoaded', initializeClickableRows);
  document.addEventListener('turbo:load', initializeClickableRows);
  document.addEventListener('turbo:render', initializeClickableRows);
  
  // 即座に実行（既にDOMが読み込まれている場合）
  if (document.readyState === 'loading') {
    // まだ読み込み中
  } else {
    // 既に読み込み完了
    initializeClickableRows();
  }
</script>
