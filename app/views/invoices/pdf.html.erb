<div class="header">
  <div style="display: flex; justify-content: space-between; align-items: flex-start;">
    <div>
      <h1 class="invoice-title">請求書</h1>
      <div class="invoice-info">
        <p>請求書番号: INV-<%= @invoice.id.to_s.rjust(6, '0') %></p>
        <p>発行日: <%= @invoice.invoice_date&.strftime("%Y年%m月%d日") %></p>
        <p>支払期限: <%= @invoice.due_date&.strftime("%Y年%m月%d日") %></p>
      </div>
    </div>
    <div class="company-info">
      <% if @user.invoice_base %>
        <h3><%= @user.invoice_base.company_name %></h3>
        <% if @user.invoice_base.department.present? %>
          <p><%= @user.invoice_base.department %></p>
        <% end %>
        <% if @user.invoice_base.address.present? %>
          <p><%= @user.invoice_base.address %></p>
        <% end %>
        <% if @user.invoice_base.email.present? %>
          <p><%= @user.invoice_base.email %></p>
        <% end %>
      <% else %>
        <h3><%= @user.name || @user.email %></h3>
      <% end %>
    </div>
  </div>
</div>

<!-- 請求先情報 -->
<div class="recipient-info">
  <div class="section-title">請求先</div>
  <% if @invoice.invoice_recipient %>
    <p><strong><%= @invoice.invoice_recipient.name %></strong></p>
    <% if @invoice.invoice_recipient.representative_name.present? %>
      <p><%= @invoice.invoice_recipient.representative_name %> 様</p>
    <% end %>
    <% if @invoice.invoice_recipient.department.present? %>
      <p><%= @invoice.invoice_recipient.department %></p>
    <% end %>
    <% if @invoice.invoice_recipient.address.present? %>
      <p><%= @invoice.invoice_recipient.address %></p>
    <% end %>
  <% end %>
</div>

<!-- 請求金額 -->
<div class="amount-section">
  <div class="amount-label">請求金額</div>
  <div class="amount-value">¥<%= number_with_delimiter(@invoice.total_amount) %></div>
</div>

<!-- 備考 -->
<% if @invoice.notes.present? %>
  <div class="notes">
    <div class="section-title">備考</div>
    <p><%= simple_format(@invoice.notes) %></p>
  </div>
<% end %>

<!-- 振込先情報 -->
<div class="bank-info">
  <div class="section-title">お振込先</div>
  <table>
    <tr>
      <td>銀行名:</td>
      <td><%= @invoice.bank_name %></td>
    </tr>
    <tr>
      <td>支店名:</td>
      <td><%= @invoice.bank_branch_name %></td>
    </tr>
    <tr>
      <td>口座種別:</td>
      <td>
        <% if @invoice.bank_account_type == 'savings' %>
          普通
        <% elsif @invoice.bank_account_type == 'checking' %>
          当座
        <% else %>
          <%= @invoice.bank_account_type %>
        <% end %>
      </td>
    </tr>
    <tr>
      <td>口座番号:</td>
      <td><%= @invoice.bank_account_number %></td>
    </tr>
    <tr>
      <td>口座名義:</td>
      <td><%= @invoice.bank_account_name %></td>
    </tr>
  </table>
</div>