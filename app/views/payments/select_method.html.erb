<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card">
        <div class="card-header bg-primary text-white">
          <h4 class="mb-0">
            <i class="fas fa-credit-card me-2"></i>
            お支払い方法を選択してください
          </h4>
        </div>
        <div class="card-body">
          <!-- 注文内容詳細 -->
          <div class="card mb-4">
            <div class="card-header bg-light">
              <h6 class="mb-0">
                <i class="fas fa-shopping-cart me-2"></i>
                ご注文内容
              </h6>
            </div>
            <div class="card-body p-0">
              <div class="table-responsive">
                <table class="table table-sm mb-0">
                  <thead class="table-light">
                    <tr>
                      <th>商品名</th>
                      <th class="text-center">数量</th>
                      <th class="text-end">単価</th>
                      <th class="text-end">小計</th>
                    </tr>
                  </thead>
                  <tbody>
                    <% @cart.cart_items.each do |item| %>
                      <tr>
                        <td>
                          <div class="fw-bold"><%= item.product.name %></div>
                          <small class="text-muted">単位: <%= item.product.display_unit %></small>
                        </td>
                        <td class="text-center">
                          <span class="badge bg-secondary"><%= item.quantity %></span>
                        </td>
                        <td class="text-end">
                          ¥<%= number_with_delimiter(item.product.price_for(current_user.level_symbol) || 0) %>
                        </td>
                        <td class="text-end fw-bold">
                          ¥<%= number_with_delimiter(item.subtotal(current_user.level_symbol)) %>
                        </td>
                      </tr>
                    <% end %>
                  </tbody>
                  <tfoot class="table-light">
                    <tr>
                      <th colspan="3" class="text-end">合計金額:</th>
                      <th class="text-end text-success fs-5">
                        ¥<%= number_with_delimiter(@total_amount) %>
                      </th>
                    </tr>
                  </tfoot>
                </table>
              </div>
            </div>
          </div>

          <!-- 支払い方法選択 -->
          <div class="row g-4">
            <!-- 銀行振込 -->
            <div class="col-md-6">
              <div class="card h-100 border-2 payment-option" style="cursor: pointer;">
                <div class="card-body text-center p-4">
                  <div class="mb-3">
                    <i class="fas fa-university fa-3x text-primary"></i>
                  </div>
                  <h5 class="card-title">銀行振込</h5>
                  <p class="card-text text-muted">
                  請求書を（振込先口座情報）登録されている<br>
                  メールアドレスにお送りします。
                  </p>
                  <ul class="list-unstyled text-start small">
                    <li><i class="fas fa-check text-success me-2"></i>振込手数料はお客様負担</li>
                    <li><i class="fas fa-check text-success me-2"></i>入金確認まで1-2営業日</li>
                    <li><i class="fas fa-check text-success me-2"></i>法人・個人どちらでも可</li>
                  </ul>
                  <%= form_with url: bank_transfer_payments_path, method: :post, local: true, class: "mt-3" do |f| %>
                    <%= f.submit "銀行振込で注文する", class: "btn btn-primary btn-lg w-100", 
                        confirm: "銀行振込で注文を確定しますか？" %>
                  <% end %>
                </div>
              </div>
            </div>

            <!-- クレジットカード -->
            <div class="col-md-6">
              <div class="card h-100 border-2 payment-option" style="cursor: pointer;">
                <div class="card-body text-center p-4">
                  <div class="mb-3">
                    <i class="fas fa-credit-card fa-3x text-success"></i>
                  </div>
                  <h5 class="card-title">クレジットカード</h5>
                  <p class="card-text text-muted">
                    VISA、MasterCard、JCB等<br>
                    主要カードブランドに対応しています。
                  </p>
                  <ul class="list-unstyled text-start small">
                    <li><i class="fas fa-check text-success me-2"></i>即座に決済完了</li>
                    <li><i class="fas fa-check text-success me-2"></i>分割払い・リボ払い対応</li>
                    <li><i class="fas fa-check text-success me-2"></i>SSL暗号化で安全</li>
                  </ul>
                  <%= form_with url: credit_card_payments_path, method: :post, local: true, class: "mt-3" do |f| %>
                    <%= f.submit "クレジットカードで注文する", class: "btn btn-success btn-lg w-100", 
                        confirm: "クレジットカード決済で注文を確定しますか？" %>
                  <% end %>
                </div>
              </div>
            </div>
          </div>

          <!-- 戻るボタン -->
          <div class="text-center mt-4">
            <%= link_to "注文内容を確認する", checkout_orders_path, class: "btn btn-outline-secondary me-2" %>
            <%= link_to "カートに戻る", cart_path, class: "btn btn-outline-primary" %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.payment-option:hover {
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  transform: translateY(-2px);
  transition: all 0.3s ease;
}

.payment-option {
  transition: all 0.3s ease;
}
</style>